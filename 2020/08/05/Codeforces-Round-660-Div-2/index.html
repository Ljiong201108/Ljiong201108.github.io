<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="对于Codeforces Round #660(Div. 2) 的解题思路和一些想法 时隔n多年再来做比赛题目QAQ 感觉又弱了好多 A. Captain Flint and Crew RecruitmentDespite his bad reputation, Captain Flint is a friendly person (at least, friendly to animals).">
<meta property="og:type" content="article">
<meta property="og:title" content="Codeforces Round #660(Div. 2)">
<meta property="og:url" content="http://yoursite.com/2020/08/05/Codeforces-Round-660-Div-2/index.html">
<meta property="og:site_name" content="Ljiong">
<meta property="og:description" content="对于Codeforces Round #660(Div. 2) 的解题思路和一些想法 时隔n多年再来做比赛题目QAQ 感觉又弱了好多 A. Captain Flint and Crew RecruitmentDespite his bad reputation, Captain Flint is a friendly person (at least, friendly to animals).">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://yoursite.com/2020/08/05/Codeforces-Round-660-Div-2/1.png">
<meta property="article:published_time" content="2020-08-04T22:52:55.000Z">
<meta property="article:modified_time" content="2020-08-20T21:22:00.977Z">
<meta property="article:author" content="Jiong Liu">
<meta property="article:tag" content="Codeforces">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2020/08/05/Codeforces-Round-660-Div-2/1.png">

<link rel="canonical" href="http://yoursite.com/2020/08/05/Codeforces-Round-660-Div-2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Codeforces Round #660(Div. 2) | Ljiong</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Ljiong</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Programm | Life</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/05/Codeforces-Round-660-Div-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jiong Liu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ljiong">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Codeforces Round #660(Div. 2)
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-05 00:52:55" itemprop="dateCreated datePublished" datetime="2020-08-05T00:52:55+02:00">2020-08-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-08-20 23:22:00" itemprop="dateModified" datetime="2020-08-20T23:22:00+02:00">2020-08-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%A2%98%E8%A7%A3/" itemprop="url" rel="index"><span itemprop="name">题解</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>对于Codeforces Round #660(Div. 2) 的解题思路和一些想法</p>
<p>时隔n多年再来做比赛题目QAQ</p>
<p>感觉又弱了好多</p>
<h4 id="A-Captain-Flint-and-Crew-Recruitment"><a href="#A-Captain-Flint-and-Crew-Recruitment" class="headerlink" title="A. Captain Flint and Crew Recruitment"></a>A. Captain Flint and Crew Recruitment</h4><p><em>Despite his bad reputation, Captain Flint is a friendly person (at least, friendly to animals). Now Captain Flint is searching worthy sailors to join his new crew (solely for peaceful purposes). A sailor is considered as worthy if he can solve Flint’s task.</em></p>
<p>Recently, out of blue Captain Flint has been interested in math and even defined a new class of integers. Let’s define a positive integer $x$ as <strong>nearly prime</strong> if it can be represented as $p⋅q$, where $1&lt;p&lt;q$ and $p$ and $q$ are prime numbers. For example, integers $6$ and $10$ are nearly primes (since $2⋅3=6$ and $2⋅5=10$), but integers $1$, $3$, $4$, $16$, $17$ or $44$ are not.</p>
<p>Captain Flint guessed an integer $n$ and asked you: can you represent it as <em>the sum of 44 <strong>different positive</strong> integers</em> where <strong>at least $3$</strong> of them should be <em>nearly prime</em>.</p>
<p>Uncle Bogdan easily solved the task and joined the crew. Can you do the same?</p>
<p>Input</p>
<p>The first line contains a single integer $t$ $(1≤t≤1000)$ — the number of test cases.</p>
<p>Next $t$ lines contain test cases — one per line. The first and only line of each test case contains the single integer $n$ $(1≤n≤2⋅10^5)$ — the number Flint guessed.</p>
<p>Output</p>
<p>For each test case print:</p>
<ul>
<li>YES and $4$ <strong>different</strong> positive integers such that at least $3$ of them are nearly prime and their sum is equal to $n$ (if there are multiple answers print any of them);</li>
<li>NO if there is no way to represent $n$ as <em>the sum of $4$ <strong>different positive</strong> integers</em> where at least $3$ of them are nearly prime.</li>
</ul>
<p>You can print each character of YES or NO in any case.</p>
<p><strong>Example</strong></p>
<p>input</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">7</span><br><span class="line">7</span><br><span class="line">23</span><br><span class="line">31</span><br><span class="line">36</span><br><span class="line">44</span><br><span class="line">100</span><br><span class="line">258</span><br></pre></td></tr></table></figure>
<p>output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">NO</span><br><span class="line">NO</span><br><span class="line">YES</span><br><span class="line">14 10 6 1</span><br><span class="line">YES</span><br><span class="line">5 6 10 15</span><br><span class="line">YES</span><br><span class="line">6 7 10 21</span><br><span class="line">YES</span><br><span class="line">2 10 33 55</span><br><span class="line">YES</span><br><span class="line">10 21 221 6</span><br></pre></td></tr></table></figure>
<p><strong>Note</strong></p>
<p>In the first and second test cases, it can be proven that there are no four different positive integers such that at least three of them are nearly prime.</p>
<p>In the third test case, $n=31=2⋅7+2⋅5+2⋅3+1$: integers $14$, $10$, $6$ are nearly prime.</p>
<p>In the fourth test case, $n=36=5+2⋅3+2⋅5+3⋅5$: integers $6$, $10$, $15$ are nearly prime.</p>
<p>In the fifth test case, $n=44=2⋅3+7+2⋅5+3⋅7$: integers $6$, $10$, $21$ are nearly prime.</p>
<p>In the sixth test case, $n=100=2+2⋅5+3⋅11+5⋅11$: integers $10$, $33$, $55$ are nearly prime.</p>
<p>In the seventh test case, $n=258=2⋅5+3⋅7+13⋅17+2⋅3$: integers $10$, $21$, $221$, $6$ are nearly prime.</p>
<h5 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h5><p>第一反应：线性筛+统计，最后输出答案</p>
<p>然而并没有那么复杂：最小的三个nearly prime分别是6，10，14，也就是说它们的和30以内是没有任何数符合条件的。对于&gt;=31的数n，就用6+10+14+k，k=n-6-10-14，如果有重复就把14换成15。</p>
<p><del>我tmd写了80多行线性筛。。。</del></p>
<p>就当是复习线性筛了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">200000</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> t, vis[MAXN+<span class="number">10</span>], cnt0, prime[MAXN+<span class="number">10</span>], collect[MAXN+<span class="number">10</span>], cnt1, flag, <span class="built_in">list</span>[MAXN+<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;  <span class="comment">//三层循环分别是前三个nearly-prime，最后判断第四个数</span></span><br><span class="line">	<span class="keyword">int</span> startPos=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=startPos;i&lt;cnt1;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(flag==<span class="number">1</span>) <span class="keyword">return</span>;  <span class="comment">//各种优化，下面同理</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">list</span>[i]&gt;=x) <span class="keyword">return</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=startPos+<span class="number">1</span>;j&lt;cnt1;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(flag==<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">if</span>(<span class="built_in">list</span>[i]+<span class="built_in">list</span>[j]&gt;=x) <span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=startPos+<span class="number">2</span>;k&lt;cnt1;k++)&#123;</span><br><span class="line">				<span class="keyword">if</span>(<span class="built_in">list</span>[i]+<span class="built_in">list</span>[j]+<span class="built_in">list</span>[k]&gt;=x) <span class="keyword">return</span>;</span><br><span class="line">				<span class="keyword">if</span>(flag==<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(i==j || j==k || k==i) <span class="keyword">continue</span>;</span><br><span class="line">                </span><br><span class="line">				<span class="keyword">if</span>(x-<span class="built_in">list</span>[i]-<span class="built_in">list</span>[j]-<span class="built_in">list</span>[k]&gt;<span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">int</span> ans=x-<span class="built_in">list</span>[i]-<span class="built_in">list</span>[j]-<span class="built_in">list</span>[k];  <span class="comment">//第4个数</span></span><br><span class="line">					<span class="keyword">if</span>(ans!=<span class="built_in">list</span>[i] &amp;&amp; ans!=<span class="built_in">list</span>[j] &amp;&amp; ans!=<span class="built_in">list</span>[k]) &#123; <span class="comment">//判重</span></span><br><span class="line">						<span class="built_in">cout</span>&lt;&lt;<span class="string">"YES"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">						<span class="built_in">cout</span>&lt;&lt;<span class="built_in">list</span>[i]&lt;&lt;<span class="string">" "</span>&lt;&lt;<span class="built_in">list</span>[j]&lt;&lt;<span class="string">" "</span>&lt;&lt;<span class="built_in">list</span>[k]&lt;&lt;<span class="string">" "</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">						flag=<span class="number">1</span>;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;t;</span><br><span class="line">    <span class="comment">//--------开筛---------</span></span><br><span class="line">	vis[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	vis[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	cnt0=<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=MAXN;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])</span><br><span class="line">            prime[++cnt0]=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=cnt0;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(i*prime[j]&gt;MAXN) <span class="keyword">break</span>;</span><br><span class="line">            vis[i*prime[j]]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//---------统计nearly-prime---------</span></span><br><span class="line">	cnt1=<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=cnt0;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(prime[i]!=<span class="number">2</span> &amp;&amp; prime[i]%<span class="number">2</span>==<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=cnt0;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(prime[j]!=<span class="number">2</span> &amp;&amp; prime[j]%<span class="number">2</span>==<span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>(i==j) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">int</span> ans=prime[i]*prime[j];</span><br><span class="line">			<span class="keyword">if</span>(ans&gt;MAXN) <span class="keyword">break</span>;</span><br><span class="line">			collect[ans]=<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=MAXN;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(collect[i]==<span class="number">1</span>) <span class="built_in">list</span>[++cnt1]=i;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//统计答案</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=t;i++)&#123;</span><br><span class="line">		<span class="keyword">int</span> temp;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;temp;</span><br><span class="line">		solve(temp);</span><br><span class="line">		<span class="keyword">if</span>(flag==<span class="number">0</span>) <span class="built_in">cout</span>&lt;&lt;<span class="string">"NO"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		flag=<span class="number">0</span>;</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="B-Captain-Flint-and-a-Long-Voyage"><a href="#B-Captain-Flint-and-a-Long-Voyage" class="headerlink" title="B. Captain Flint and a Long Voyage"></a>B. Captain Flint and a Long Voyage</h4><p><em>Captain Flint and his crew keep heading to a savage shore of Byteland for several months already, drinking rum and telling stories. In such moments uncle Bogdan often remembers his nephew Denis. Today, he has told a story about how Denis helped him to come up with an interesting problem and asked the crew to solve it.</em></p>
<p>In the beginning, uncle Bogdan wrote on a board a positive integer $x$ consisting of $n$ digits. After that, he wiped out $x$ and wrote integer $k$ instead, which was the concatenation of binary representations of digits $x$ consists of (without leading zeroes). For example, let $x=729$, then $k=111101001$ (since $7=111$, $2=10$, $9=1001$).</p>
<p>After some time, uncle Bogdan understood that he doesn’t know what to do with $k$ and asked Denis to help. Denis decided to wipe last $n$ digits of $k$ and named the new number as $r$.</p>
<p>As a result, Denis proposed to find such integer $x$ of length $n$ that $r$ (as number) is maximum possible. If there are multiple valid $x$ then Denis is interested in the minimum one.</p>
<p>All crew members, including captain Flint himself, easily solved the task. All, except cabin boy Kostya, who was too drunk to think straight. But what about you?</p>
<p>Note: in this task, we compare integers ($x$ or $k$) as numbers (despite what representations they are written in), so $729&lt;1999$ or $111&lt;1000$.</p>
<p><strong>Input</strong></p>
<p>The first line contains a single integer $t$ ($1≤t≤1000$) — the number of test cases.</p>
<p>Next $t$ lines contain test cases — one per test case. The one and only line of each test case contains the single integer $n$ ($1≤n≤10^5$) — the length of the integer $x$ you need to find.</p>
<p>It’s guaranteed that the sum of $n$ from all test cases doesn’t exceed $2⋅10^5$.</p>
<p><strong>Output</strong></p>
<p>For each test case, print the minimum integer $x$ of length $n$ such that obtained by Denis number $r$ is maximum possible.</p>
<p><strong>Example</strong></p>
<p>input</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">1</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
<p>output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">8</span><br><span class="line">998</span><br></pre></td></tr></table></figure>
<p><strong>Note</strong></p>
<p>In the second test case (with $n=3$), if uncle Bogdan had $x=998$ then $k=100110011000$. Denis (by wiping last $n=3$ digits) will obtain $r=100110011$.</p>
<p>It can be proved that the 100110011100110011 is the maximum possible $r$ Denis can obtain and 998998 is the minimum $x$ to obtain it.</p>
<h5 id="思路-1"><a href="#思路-1" class="headerlink" title="思路"></a>思路</h5><p>因为比较是按照数字的方式比较，所以位数多的数一定大，所以要最大只能用$9=1001$和$8=1000$来占位。然后尾部要被抹掉的位置用8来使相同答案中最小的数。位数是4的倍数的时候要特判。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, t;</span><br><span class="line"><span class="built_in">string</span> ans=<span class="string">""</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;t;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=t;j++)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">		<span class="keyword">switch</span>(n%<span class="number">4</span>)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n-n/<span class="number">4</span>;i++) ans+=<span class="string">'9'</span>;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n/<span class="number">4</span>;i++) ans+=<span class="string">'8'</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">default</span>:&#123;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n-n/<span class="number">4</span><span class="number">-1</span>;i++) ans+=<span class="string">'9'</span>;</span><br><span class="line">				<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n/<span class="number">4</span>+<span class="number">1</span>;i++) ans+=<span class="string">'8'</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">			</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">		ans.clear();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="C-Uncle-Bogdan-and-Country-Happiness"><a href="#C-Uncle-Bogdan-and-Country-Happiness" class="headerlink" title="C. Uncle Bogdan and Country Happiness"></a>C. Uncle Bogdan and Country Happiness</h4><p><em>Uncle Bogdan is in captain Flint’s crew for a long time and sometimes gets nostalgic for his homeland. Today he told you how his country introduced a happiness index.</em></p>
<p>There are $n$ cities and $n−1$ undirected roads connecting pairs of cities. Citizens of any city can reach any other city traveling by these roads. Cities are numbered from 11 to $n$ and the city 11 is a capital. In other words, the country has a tree structure.</p>
<p>There are $m$ citizens living in the country. A $p_i$ people live in the $i$-th city but all of them are working in the capital. At evening all citizens return to their home cities using the shortest paths.</p>
<p>Every person has its own mood: somebody leaves his workplace in good mood but somebody are already in bad mood. Moreover any person can ruin his mood on the way to the hometown. <strong>If person is in bad mood he won’t improve it</strong>.</p>
<p>Happiness detectors are installed in each city to monitor the happiness of <strong>each</strong> person who visits the city. The detector in the $i$-th city calculates a happiness index $h_i$ as the number of people in good mood minus the number of people in bad mood. Let’s say for the simplicity that <em>mood of a person doesn’t change inside the city</em>.</p>
<p>Happiness detector is still in development, so there is a probability of a mistake in judging a person’s happiness. One late evening, when all citizens successfully returned home, the government asked uncle Bogdan (the best programmer of the country) to check the correctness of the collected happiness indexes.</p>
<p>Uncle Bogdan successfully solved the problem. Can you do the same?</p>
<p>More formally, <em>You need to check: “Is it possible that, after all people return home, for each city $i$ the happiness index will be equal exactly to $h_i$”.</em></p>
<p><strong>Input</strong></p>
<p>The first line contains a single integer $t$ (1≤t≤100001≤t≤10000) — the number of test cases.</p>
<p>The first line of each test case contains two integers $n$ and $m$ ($1≤n≤10^5$; $0≤m≤10^9$) — the number of cities and citizens.</p>
<p>The second line of each test case contains $n$ integers p1,p2,…,pnp1,p2,…,pn ($0≤pi≤m$; $p_1+p_2+…+p_n=m$), where $p_i$ is the number of people living in the $i$-th city.</p>
<p>The third line contains $n$ integers $h_1,h_2,…,h_n$ ($−10^9≤h_i≤10^9$), where $h_i$ is the calculated happiness index of the $i$-th city.</p>
<p>Next $n−1$ lines contain description of the roads, one per line. Each line contains two integers $x_i$ and $y_i$ ($1≤x_i,y_i≤n$; $x_i≠y_i$), where xixi and yiyi are cities connected by the $i$-th road.</p>
<p>It’s guaranteed that the sum of $n$ from all test cases doesn’t exceed $2⋅10^5$.</p>
<p><strong>Output</strong></p>
<p>For each test case, print YES, if the collected data is correct, or NO — otherwise. You can print characters in YES or NO in any case.</p>
<p><strong>Examples</strong></p>
<p>input</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">7 4</span><br><span class="line">1 0 1 1 0 1 0</span><br><span class="line">4 0 0 -1 0 -1 0</span><br><span class="line">1 2</span><br><span class="line">1 3</span><br><span class="line">1 4</span><br><span class="line">3 5</span><br><span class="line">3 6</span><br><span class="line">3 7</span><br><span class="line">5 11</span><br><span class="line">1 2 5 2 1</span><br><span class="line">-11 -2 -6 -2 -1</span><br><span class="line">1 2</span><br><span class="line">1 3</span><br><span class="line">1 4</span><br><span class="line">3 5</span><br></pre></td></tr></table></figure>
<p>output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">YES</span><br><span class="line">YES</span><br></pre></td></tr></table></figure>
<p>input</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">4 4</span><br><span class="line">1 1 1 1</span><br><span class="line">4 1 -3 -1</span><br><span class="line">1 2</span><br><span class="line">1 3</span><br><span class="line">1 4</span><br><span class="line">3 13</span><br><span class="line">3 3 7</span><br><span class="line">13 1 4</span><br><span class="line">1 2</span><br><span class="line">1 3</span><br></pre></td></tr></table></figure>
<p>output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NO</span><br><span class="line">NO</span><br></pre></td></tr></table></figure>
<p><strong>Note</strong></p>
<p>more see: <a href="https://codeforces.com/contest/1388/problem/C" target="_blank" rel="noopener">https://codeforces.com/contest/1388/problem/C</a></p>
<h5 id="思路-2"><a href="#思路-2" class="headerlink" title="思路"></a>思路</h5><p>从根节点开始遍历，计算子节点的happy和bad人数是否符合条件，如果不符合条件直接退出。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> t, n, m, flag;</span><br><span class="line"><span class="keyword">int</span> P[<span class="number">100010</span>], H[<span class="number">100010</span>], vis[<span class="number">100010</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">city</span>&#123;</span></span><br><span class="line">	<span class="keyword">int</span> citz, citzAll;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; pathTo;</span><br><span class="line">&#125;C[<span class="number">100010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;  <span class="comment">//初始化图，保证从根节点到叶子节点是单向的</span></span><br><span class="line">	C[x].citzAll=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; tempV;</span><br><span class="line">	</span><br><span class="line">	vis[x]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;C[x].pathTo.size();i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(vis[C[x].pathTo[i]]==<span class="number">0</span>)&#123;</span><br><span class="line">			tempV.push_back(C[x].pathTo[i]);</span><br><span class="line">			C[x].citzAll+=init(C[x].pathTo[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line">	C[x].citzAll+=C[x].citz;</span><br><span class="line">	C[x].pathTo=tempV;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> C[x].citzAll;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;  <span class="comment">//输出打印，只是为了让检查</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;i&lt;&lt;<span class="string">"--&gt;"</span>&lt;&lt;C[i].pathTo.size()&lt;&lt;<span class="string">"|| "</span>&lt;&lt;C[i].citzAll&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;C[i].pathTo.size();j++)&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;C[i].pathTo[j]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> happy)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(flag!=<span class="number">0</span>) &#123;  <span class="comment">//如果有一个地方不符合直接退出</span></span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(C[x].pathTo.size()==<span class="number">0</span>) <span class="keyword">return</span>;  <span class="comment">//如果没有能继续走的子节点就返回</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> hNum=happy, bNum=C[x].citzAll-happy; <span class="comment">//根节点的happy和bad人数</span></span><br><span class="line">	<span class="keyword">int</span> bReq=<span class="number">0</span>, hReq=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; tempH;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;C[x].pathTo.size();i++)&#123;</span><br><span class="line">		<span class="keyword">int</span> b=<span class="number">0</span>, h=<span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//wrong，除不尽</span></span><br><span class="line">		<span class="keyword">if</span>((C[C[x].pathTo[i]].citzAll+H[C[x].pathTo[i]]) % <span class="number">2</span> !=<span class="number">0</span>) flag=<span class="number">1</span>; </span><br><span class="line">		</span><br><span class="line">		h=(C[C[x].pathTo[i]].citzAll+H[C[x].pathTo[i]])/<span class="number">2</span>;</span><br><span class="line">		b=(C[C[x].pathTo[i]].citzAll-H[C[x].pathTo[i]])/<span class="number">2</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(h&lt;<span class="number">0</span> || b&lt;<span class="number">0</span>) flag=<span class="number">2</span>; <span class="comment">//wrong，出现负数</span></span><br><span class="line">		tempH.push_back(h);</span><br><span class="line">		</span><br><span class="line">		bReq+=b;</span><br><span class="line">		hReq+=h;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//判断：总数不能变，happy人数不能增加</span></span><br><span class="line">	<span class="keyword">if</span>((hNum+bNum-C[x].citz)==(hReq+bReq) &amp;&amp; hReq&lt;=hNum)&#123;  </span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;C[x].pathTo.size();i++)&#123;</span><br><span class="line">			dfs(C[x].pathTo[i], tempH[i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;<span class="keyword">else</span> flag=<span class="number">3</span>;</span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">cin</span>&gt;&gt;C[i].citz;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">cin</span>&gt;&gt;H[i];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) C[i].pathTo.clear();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">int</span> a=<span class="number">0</span>, b=<span class="number">0</span>;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b;</span><br><span class="line">		C[a].pathTo.push_back(b);</span><br><span class="line">		C[b].pathTo.push_back(a);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	init(<span class="number">1</span>);  <span class="comment">//从根节点开始初始化</span></span><br><span class="line">    <span class="comment">//对根节点进行判断</span></span><br><span class="line">	<span class="keyword">if</span>((C[<span class="number">1</span>].citzAll+H[<span class="number">1</span>]) % <span class="number">2</span> !=<span class="number">0</span>) flag=<span class="number">1</span>;  </span><br><span class="line">	<span class="keyword">int</span> h=(C[<span class="number">1</span>].citzAll+H[<span class="number">1</span>])/<span class="number">2</span>, b=(C[<span class="number">1</span>].citzAll-H[<span class="number">1</span>])/<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">if</span>(h&lt;<span class="number">0</span> || b&lt;<span class="number">0</span>) flag=<span class="number">2</span>;</span><br><span class="line">	dfs(<span class="number">1</span>, h);<span class="comment">//开始遍历</span></span><br><span class="line">    </span><br><span class="line">	<span class="keyword">if</span>(flag==<span class="number">0</span>) <span class="built_in">cout</span>&lt;&lt;<span class="string">"YES"</span>&lt;&lt;<span class="built_in">endl</span>;<span class="comment">//如果没问题输出“YES”</span></span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;<span class="string">"NO"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//重置</span></span><br><span class="line">	flag=<span class="number">0</span>; </span><br><span class="line">	<span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;t;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=t;i++)&#123;</span><br><span class="line">		solve();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="D-Captain-Flint-and-Treasure（存在问题）"><a href="#D-Captain-Flint-and-Treasure（存在问题）" class="headerlink" title="D. Captain Flint and Treasure（存在问题）"></a>D. Captain Flint and Treasure（存在问题）</h4><p><em>Captain Fint is involved in another treasure hunt, but have found only one strange problem. The problem may be connected to the treasure’s location or may not. That’s why captain Flint decided to leave the solving the problem to his crew and offered an absurdly high reward: one day off. The problem itself sounds like this…</em></p>
<p>There are two arrays $a$ and $b$ of length $n$. Initially, an ansans is equal to $0$ and the following operation is defined:</p>
<ol>
<li>Choose position $i$ ($1≤i≤n$);</li>
<li>Add $a_i$ to $ans$;</li>
<li>If $b_i≠−1$ then add $a_i$ to $a_{b_i}$.</li>
</ol>
<p>What is the maximum ansans you can get by performing the operation on each $i$ (1≤i≤n1≤i≤n) <em>exactly once</em>?</p>
<p>Uncle Bogdan is eager to get the reward, so he is asking your help to find the optimal order of positions to perform the operation on them.</p>
<p>Input</p>
<p>The first line contains the integer $n$ ($1≤n≤2⋅10^5$) — the length of arrays $a$ and $b$.</p>
<p>The second line contains $n$ integers $a_1,a_2,…,a_n$ ($−10^6≤a_i≤10^6$).</p>
<p>The third line contains $n$ integers $b_1,b_2,…,b_n$ ($1≤bi≤n$ or $b_i=−1$).</p>
<p><strong>Additional constraint: it’s guaranteed that for any $i$ ($1≤i≤n$) the sequence $b_i,b_{b_i},b_{b{b_i}},…$ is not cyclic, in other words it will always end with $−1$.</strong></p>
<p><strong>Output</strong></p>
<p>In the first line, print the maximum $ans$ you can get.</p>
<p>In the second line, print the order of operations: $n$ different integers $p_1,p_2,…,p_n$ ($1≤pi≤n$). The $p_i$ is the position which should be chosen at the $i$-th step. If there are multiple orders, print any of them.</p>
<p><strong>Examples</strong></p>
<p>input</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">1 2 3</span><br><span class="line">2 3 -1</span><br></pre></td></tr></table></figure>
<p>output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10</span><br><span class="line">1 2 3</span><br></pre></td></tr></table></figure>
<p>input</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">-1 100</span><br><span class="line">2 -1</span><br></pre></td></tr></table></figure>
<p>output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">99</span><br><span class="line">2 1</span><br></pre></td></tr></table></figure>
<p>input</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">10</span><br><span class="line">-10 -1 2 2 5 -2 -3 -4 2 -6</span><br><span class="line">-1 -1 2 2 -1 5 5 7 7 9</span><br></pre></td></tr></table></figure>
<p>output</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-9</span><br><span class="line">3 5 6 1 9 4 10 7 8 2</span><br></pre></td></tr></table></figure>
<h5 id="思路-3"><a href="#思路-3" class="headerlink" title="思路"></a>思路</h5><p>我用拓扑排序来遍历所有节点。</p>
<p>拿最后一个测试样例来说，建好图应该是一个DAG</p>
<p><img src="/2020/08/05/Codeforces-Round-660-Div-2/1.png" alt></p>
<p>一个负数的节点指向的节点一定要在这个节点之后更新，比如10号节点必须在9号节点之后更新。需要等待更新的节点最后更新也没问题。</p>
<p>每次遍历从出度为零的点开始dfs，这样计算的时候就是从底部依次返回。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN=<span class="number">200010</span>;</span><br><span class="line"><span class="keyword">int</span> n, A[MAXN], B[MAXN], outd[MAXN], ans;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; pathTo[MAXN], <span class="built_in">list</span>, tempV;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(pathTo[x].size()==<span class="number">0</span>) <span class="keyword">return</span>; <span class="comment">//没有子节点，返回</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;pathTo[x].size();i++)&#123;</span><br><span class="line">		dfs(pathTo[x][i]);  <span class="comment">//先更新子节点</span></span><br><span class="line">		<span class="keyword">int</span> son=A[pathTo[x][i]];</span><br><span class="line">		<span class="keyword">if</span>(son&lt;<span class="number">0</span>)&#123;</span><br><span class="line">			tempV.push_back(pathTo[x][i]); <span class="comment">//是个负数，要等待其他节点更新，最后再加 </span></span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			A[x]+=son;</span><br><span class="line">			ans+=son;</span><br><span class="line">			<span class="built_in">list</span>.push_back(pathTo[x][i]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;  <span class="comment">//打印图，只是为了检查</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;i&lt;&lt;<span class="string">"--&gt;"</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;pathTo[i].size();j++)&#123;</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;pathTo[i][j]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;A[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="keyword">int</span> temp;</span><br><span class="line">		<span class="built_in">cin</span>&gt;&gt;temp;</span><br><span class="line">		<span class="keyword">if</span>(temp==<span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">		pathTo[temp].push_back(i);</span><br><span class="line">		outd[i]++;<span class="comment">//统计出度</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; start;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(outd[i]==<span class="number">0</span>) &#123;  <span class="comment">//统计起点</span></span><br><span class="line">			start.push_back(i);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;start.size();i++)&#123;  <span class="comment">//第一轮更新</span></span><br><span class="line">		dfs(start[i]);</span><br><span class="line">		ans+=A[start[i]];</span><br><span class="line">		<span class="built_in">list</span>.push_back(start[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;tempV.size();i++)&#123;  <span class="comment">//更新要等待的节点</span></span><br><span class="line">		ans+=A[tempV[i]];</span><br><span class="line">		<span class="built_in">list</span>.push_back(tempV[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="built_in">endl</span>;  <span class="comment">//输出</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">list</span>.size();i++)&#123;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="built_in">list</span>[i]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Codeforces/" rel="tag"># Codeforces</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/08/05/%E5%A6%82%E4%BD%95%E5%9C%A8hexo%E6%A1%86%E6%9E%B6%E7%9A%84%E5%8D%9A%E5%AE%A2%E4%B8%AD%E4%BD%BF%E7%94%A8mathjax/" rel="prev" title="如何在hexo框架的博客中使用mathjax">
      <i class="fa fa-chevron-left"></i> 如何在hexo框架的博客中使用mathjax
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/08/06/Codeforces-Round-661-Div-3/" rel="next" title="Codeforces Round #661 (Div. 3)">
      Codeforces Round #661 (Div. 3) <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#A-Captain-Flint-and-Crew-Recruitment"><span class="nav-number">1.</span> <span class="nav-text">A. Captain Flint and Crew Recruitment</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#思路"><span class="nav-number">1.1.</span> <span class="nav-text">思路</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#B-Captain-Flint-and-a-Long-Voyage"><span class="nav-number">2.</span> <span class="nav-text">B. Captain Flint and a Long Voyage</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#思路-1"><span class="nav-number">2.1.</span> <span class="nav-text">思路</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#C-Uncle-Bogdan-and-Country-Happiness"><span class="nav-number">3.</span> <span class="nav-text">C. Uncle Bogdan and Country Happiness</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#思路-2"><span class="nav-number">3.1.</span> <span class="nav-text">思路</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#D-Captain-Flint-and-Treasure（存在问题）"><span class="nav-number">4.</span> <span class="nav-text">D. Captain Flint and Treasure（存在问题）</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#思路-3"><span class="nav-number">4.1.</span> <span class="nav-text">思路</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jiong Liu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">22</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jiong Liu</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

    

  

</body>
</html>
